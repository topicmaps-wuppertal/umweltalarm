{"version":3,"sources":["md5Fetching.js","search.js","components/LoginForm.js","components/TitleControl.js","components/InfoBox.js","version.js","components/MenuFooter.js","components/Menu.js","components/SecondaryInfo.js","Crosshair.js","UmweltalarmMap.js","offlineConfig.js","App.js","reportWebVitals.js","serviceWorkerRegistration.js","index.js"],"names":["md5ActionFetchDAQ4Dexie","prefix","apiUrl","jwt","daqKey","db","a","table","get","name","allObjects","md5InCache","md5","console","log","taskParameters","parameters","fd","FormData","append","Blob","JSON","stringify","type","time","Promise","resolve","reject","data","fetch","method","headers","Authorization","body","response","status","json","content","res","result","parse","newData","update","id","add","geojson","indexGeometries","desc","exception","index","Flatbush","length","tableObject","clear","el","geo","getBoundsFromArea","i","push","bulkPut","finish","changes","indexAnsprechpartner","indexAnsprechpartnerZustaendigkeit","tabelle","referenz","referenzfeld","area","bboxArray","turfBbox","nameMapping","daqTableMapping","searchForFeatures","daqKeys","geom","hits","geomBounds","ansprechpartner","ansprechpartnerZustaendigkeit","trinkwasserbrunnen","trinkwasserbrunnenDist","bimsch","bimschDist","allBimsch","allTrinkwasserbrunnen","allFlurstuecke","key","metaTable","tableObjects","otable","serIndex","pol_index","from","indizes","search","o","obj","geoj","booleanIntersects","distanceInMeters","getDistance","addAnsprechpartner","Math","round","dienststellen","split","dienststellenOld","ansprechpartnerArray","stelle","undefined","geometry","centerGeom","turfCenter","sort","compareDist","Array","prototype","apply","filter","value","arr","typ","elA1","betrieb","b","abstand","geomCenter","geomCenterCoords","coordinates","transformedGeom","proj4","defs","brunnenCenter","brunnenCoords","transformedBrunnen","turfDistance","unit","dataObject","keys","Object","found","anprechreferenz","anspr","removeNullValues","offlineDataAvailable","lastTime","dayjs","extend","customParseFormat","LoginForm","setJWT","loginInfo","setLoginInfo","setLoggedOut","windowSize","useContext","ResponsiveTopicMapContext","setMetaInformation","FeatureCollectionDispatchContext","setAppMenuVisible","UIDispatchContext","pwFieldRef","useRef","userFieldRef","modalBodyStyle","overflowY","overflowX","maxHeight","height","useState","user","_setUser","pw","setPw","cacheDataAvailable","setCacheDataAvailable","window","localforage","setUser","setItem","appKey","useEffect","getItem","userInCache","dataValueInCache","toDate","current","focus","select","login","btoa","then","responseWithJWT","color","text","setTimeout","catch","err","Modal","style","zIndex","size","show","keyboard","Header","Title","Icon","Body","Form","Group","controlId","Label","Control","ref","onChange","e","target","onKeyPress","event","placeholder","width","display","alignItems","flexDirection","justifyContent","margin","maxWidth","flexShrink","Button","onClick","CACHE_JWT","marginTop","variant","dateInfo","secondaryInfo","jwtPayload","actiontext","logout","metaInformation","FeatureCollectionContext","t","Date","toLocaleString","atob","sub","titleContent","float","paddingRight","position","left","top","textAlign","verticalAlign","background","opacity","paddingLeft","modes","InfoBox","mode","setFeatureCollectionVisible","isFeatureCollectionVisible","collapsedInfoBox","UIContext","setCollapsedInfoBox","setSecondaryInfoVisible","hitsObject","isArray","brunnen","strassenmeisterei","schutzgebiete","autobahnmeisterei","wasserschutzgebiete","verbaende","stoerfallbetriebe","stadtFlurstuecke","header","paddingTop","paddingBottom","fontSize","activeStyle","border","borderStyle","flexGrow","inactiveStyle","subtextStyle","minHeight","gridStyle","gridGap","gridTemplateColumns","flexWrap","alignContent","symbols","active","spinner","title","icon","faFaucet","faIndustry","faHandHoldingWater","default_name","faExclamationCircle","faCity","faTree","ResponsiveInfoBox","panelClick","pixelwidth","isCollapsible","collapsibleStyle","handleResponsiveDesign","infoStyle","padding","alwaysVisibleDiv","collapsibleDiv","fixedRow","secondaryInfoBoxElements","marginBottom","faMap","APPERSION","getApplicationVersion","Footer","setAppMenuActiveMenuSection","className","scroller","scrollTo","containerId","document","href","reactCismapVersion","rel","MyMenu","ModalApplicationMenu","menuIcon","menuTitle","menuIntroduction","menuSections","DefaultSettingsPanel","skipFilterTitleSettings","skipClusteringSettings","skipSymbolsizeSetting","previewMapPosition","Section","sectionKey","sectionTitle","sectionBsStyle","sectionContent","listStyleType","marginRight","alt","src","process","ConfigurableDocBlocks","configs","getSimpleHelpForTM","menuFooter","MenuFooter","objectifyHits","hitObject","hit","firma","footer","getAnsprechpartnerLinks","links","keyPostfix","tel","IconLink","tooltip","iconname","email","url","getAnsprechpartner","map","bemerkung","getDienststellen","dienststellenArray","styleParam","trim","borderBottom","getSeparator","backgroundColor","xcolor","InfoPanel","history","TopicMapContext","lat","URLSearchParams","location","long","showRawData","subSections","valFunc","join","wasserverbaende","SecondaryInfoPanelSection","bsStyle","flurstueck","bimschWuppertal","bimschNrw","naturschutzgebiete","landschaftsschutzgebiete","StoerfallBetriebeKlasse1","StoerfallBetriebeKlasse2","str_name","hsnr","zusatz","b_firma1","anlag_bez","zone","nrw_name","nrw_nummer","sg_typ","lage","hitsForRawDisplay","hitObjectForRawDisplay","SecondaryInfo","titleIconName","mainSection","bezeichnung","groesse","stadtbezirke","sb","quartiere","q","eigentuemer","Comp","pointerEvents","borderRadius","host","getData","setGazData","sources","md5FetchText","adressen","bezirke","pois","kitas","gazData","getGazDataForTopicIds","convertToFeature","_item","item","opcaity","selected","crs","properties","feature","fillColor","Color","darken","fillOpacity","weight","UmweltalarmMap","loggedOut","initialised","routedMapRef","mapRef","leafletMap","leafletElement","currentZoom","getZoom","setHits","searchMode","setSearchMode","featureCollection","setFeatureCollection","bbPoly","setBBPoly","features","f","searchInWholeWindowEnabled","Crosshair","TopicMapComponent","modalMenu","homeZoom","maxZoom","applicationMenuTooltipString","locatorControl","mappingBoundsChanged","boundingBox","bbox","bottom","right","bboxPolygon","center","disabled","transform","faSearch","faSquare","offlineConfig","rules","origin","cachePath","realServerFallback","dataStores","offlineStyles","consoleDebug","optional","initialActive","Dexie","schema","version","stores","initTables","App","backgroundModes","showConsole","_setJWT","setInitialised","checkedForJWT","setCheckedForJWT","jwtInCache","tasks","all","results","problem","getInternetExplorerVersion","layerKey","offlineDataStoreKey","baseLayerConf","defaultLayerConf","namedLayers","cismetLight","offlineAvailable","pane","osmBrightOffline","loginForm","TopicMapContextProvider","additionalLayerConfiguration","layer","MapLibreLayer","kanal","gewaesser","offlineCacheConfig","backgroundConfigurations","lbk","layerkey","stadtplan","vectorCityMap2","vectorCityMap","referenceSystem","MappingConstants","crs3857","mapEPSGCode","referenceSystemDefinition","proj4crs3857def","maskingPolygon","LogConsole","ghostModeAvailable","minifyAvailable","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","onUpdate","onSuccess","error","ReactDOM","render","StrictMode","getElementById","URL","addEventListener","contentType","indexOf","ready","unregister","reload","checkValidServiceWorker","serviceWorkerRegistration"],"mappings":"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","file":"static/js/main.bbe8193c.chunk.js","sourcesContent":["import Dexie from \"dexie\";\nimport Flatbush from \"flatbush\";\nimport turfBbox from \"@turf/bbox\";\n\nexport const CACHE_JWT = \"--cached--data--\";\n\nexport const initTables = (prefix, daqKeys) => {\n  const db = new Dexie(prefix);\n  const schema = {};\n  for (const key of daqKeys) {\n    schema[key] = \"gid\";\n  }\n  schema[\"daq_meta\"] = \"++id,name,md5,time\";\n  schema[\"anprechp\"] = \"id\";\n  schema[\"zustaendigkeit\"] = \"id,tabelle,referenzfeld,referenz,[tabelle+referenzfeld+referenz]\";\n\n  db.version(10).stores(schema);\n\n  return db;\n};\n\nexport const md5ActionFetchDAQ4Dexie = async (prefix, apiUrl, jwt, daqKey, db) => {\n  const allObjects = await db.table(\"daq_meta\").get({ name: daqKey });\n  let md5InCache = null;\n\n  if (allObjects != null) {\n    md5InCache = allObjects.md5;\n  }\n\n  console.log(\"DAQ for \" + daqKey);\n\n  let taskParameters = {\n    parameters: {\n      daqKey,\n      md5: md5InCache || \"-\",\n    },\n  };\n\n  let fd = new FormData();\n  fd.append(\n    \"taskparams\",\n    new Blob([JSON.stringify(taskParameters)], {\n      type: \"application/json\",\n    })\n  );\n\n  if (jwt === CACHE_JWT) {\n    const data = \"data retrieved\";\n\n    //go for result.time after the new version of the action is live\n    const time = allObjects.time;\n    return new Promise((resolve, reject) => {\n      resolve({ data, time });\n    });\n  } else {\n    const response = await fetch(\n      apiUrl + \"/actions/WUNDA_BLAU.dataAquisition/tasks?resultingInstanceType=result\",\n      {\n        method: \"POST\",\n        // method: \"GET\",\n        headers: {\n          Authorization: \"Bearer \" + jwt,\n          // \"Content-Type\": \"application/json\",\n          // Accept: \"application/json\",\n        },\n        body: fd,\n      }\n    );\n\n    if (response.status >= 200 && response.status < 300) {\n      const content = await response.json();\n      if (content.res) {\n        try {\n          const result = JSON.parse(content.res);\n          let status = result.status;\n          let data, time;\n\n          if (status === 200) {\n            console.log(\"DAQ cache miss for \" + daqKey);\n\n            data = JSON.parse(result.content);\n            time = result.time;\n            const newData = {};\n            newData[\"md5\"] = result.md5;\n            newData[\"time\"] = time;\n            newData[\"name\"] = daqKey;\n            console.log(\"new md5: \" + newData.md5);\n\n            if (allObjects != null) {\n              await db.table(\"daq_meta\").update(allObjects.id, newData);\n            } else {\n              db.table(\"daq_meta\").add(newData);\n            }\n            //              console.time(\"index time\"+daqKey)\n            if (data && data[0] && data[0].geojson) {\n              await indexGeometries(data, daqKey, prefix, db);\n            }\n            //              console.timeEnd(\"index time\"+daqKey)\n          } else if (status === 304) {\n            console.log(\"DAQ cache hit for \" + daqKey);\n            //go for result.time after the new version of the action is live\n\n            if (allObjects != null) {\n              time = allObjects.time;\n              data = \"data retrieved\";\n            }\n          }\n\n          return new Promise((resolve, reject) => {\n            resolve({ data, daqKey, time });\n          });\n        } catch (e) {\n          return new Promise((resolve, reject) => {\n            reject({\n              status: 500,\n              desc: \"error when parsing the server result. probably the content has the wrong structure\",\n              content,\n              exception: e,\n            });\n          });\n        }\n      } else {\n        return new Promise((resolve, reject) => {\n          reject({\n            status: 500,\n            desc: \"error when parsing the server result.\",\n            content,\n          });\n        });\n      }\n    } else if (response.status === 401) {\n      return new Promise((resolve, reject) => {\n        reject({ status: response.status, daqKey, desc: \"unauthorized\" });\n      });\n    } else {\n      return new Promise((resolve, reject) => {\n        reject({ status: response.status, daqKey, desc: \"unknown\" });\n      });\n    }\n  }\n};\n\nexport const indexGeometries = async (content, table, prefix, db) => {\n  const index = new Flatbush(content.length);\n  const tableObject = db.table(table);\n  await tableObject.clear();\n\n  const data = [];\n\n  for (const el of content) {\n    const geo = getBoundsFromArea(el.geojson);\n    const i = index.add(geo[0][1], geo[0][0], geo[1][1], geo[1][0]);\n    const newData = {};\n    newData[\"gid\"] = i;\n    newData[\"data\"] = el;\n    data.push(newData);\n  }\n\n  await tableObject.bulkPut(data);\n  index.finish();\n\n  const allObjects = await db.table(\"daq_meta\").get({ name: table });\n  const changes = {};\n  changes[\"pol_index\"] = index.data;\n  await db.table(\"daq_meta\").update(allObjects.id, changes);\n};\n\nexport const indexAnsprechpartner = async (content, table, db) => {\n  const tableObject = db.table(\"anprechp\");\n  await tableObject.clear();\n\n  const data = [];\n\n  for (const el of content) {\n    const newData = {};\n    newData[\"id\"] = el.id;\n    newData[\"data\"] = el;\n    data.push(newData);\n  }\n\n  await tableObject.bulkPut(data);\n};\n\nexport const indexAnsprechpartnerZustaendigkeit = async (content, table, db) => {\n  const tableObject = db.table(\"zustaendigkeit\");\n  await tableObject.clear();\n\n  const data = [];\n\n  for (const el of content) {\n    const newData = {};\n    newData[\"id\"] = el.id;\n    newData[\"tabelle\"] = el.tabelle;\n    newData[\"referenz\"] = el.referenz;\n    newData[\"referenzfeld\"] = el.referenzfeld;\n    newData[\"data\"] = el;\n    data.push(newData);\n  }\n\n  await tableObject.bulkPut(data);\n};\n\nexport const getBoundsFromArea = (area) => {\n  const bboxArray = turfBbox(area);\n  const corner1 = [bboxArray[1], bboxArray[0]];\n  const corner2 = [bboxArray[3], bboxArray[2]];\n  const bounds = [corner1, corner2];\n\n  return bounds;\n};\n","import Flatbush from \"flatbush\";\nimport { getBoundsFromArea } from \"./md5Fetching\";\nimport booleanIntersects from \"@turf/boolean-intersects\";\nimport turfDistance from \"@turf/distance\";\nimport turfCenter from \"@turf/center\";\nimport proj4 from \"proj4\";\n\nexport const nameMapping = {};\nnameMapping[\"StoerfallBetriebeKlasse1\"] = \"betrieb\";\nnameMapping[\"StoerfallBetriebeKlasse2\"] = \"betrieb\";\nnameMapping[\"wasserverbaende\"] = \"name\";\nnameMapping[\"wasserschutzgebiete\"] = \"zone\";\nnameMapping[\"autobahnmeisterei\"] = \"bezirk\";\nnameMapping[\"landschaftsschutzgebiete\"] = \"sg_typ\";\nnameMapping[\"naturschutzgebiete\"] = \"sg_nummer\";\nnameMapping[\"strassenmeisterei\"] = \"bezirk\";\nnameMapping[\"bimschNrw\"] = \"astnr\";\nnameMapping[\"bimschWuppertal\"] = \"astnr\";\nnameMapping[\"trinkwasserbrunnen\"] = \"str_name\";\nnameMapping[\"stadtFlurstuecke\"] = \"dienststellen\";\n\nexport const daqTableMapping = {};\ndaqTableMapping[\"StoerfallBetriebeKlasse1\"] = \"stoerfallbetriebe_klasse1\";\ndaqTableMapping[\"StoerfallBetriebeKlasse2\"] = \"stoerfallbetriebe_klasse2\";\ndaqTableMapping[\"wasserverbaende\"] = \"wasserverbaende\";\ndaqTableMapping[\"wasserschutzgebiete\"] = \"wasserschutzgebiete\";\ndaqTableMapping[\"autobahnmeisterei\"] = \"autobahnmeisterei\";\ndaqTableMapping[\"landschaftsschutzgebiete\"] = \"landschaftsschutzgebiete\";\ndaqTableMapping[\"naturschutzgebiete\"] = \"naturschutzgebiete\";\ndaqTableMapping[\"strassenmeisterei\"] = \"strassenmeisterei\";\ndaqTableMapping[\"bimschNrw\"] = \"bimsch_nrw\";\ndaqTableMapping[\"bimschWuppertal\"] = \"bimsch_wuppertal\";\ndaqTableMapping[\"trinkwasserbrunnen\"] = \"trinkwasserbrunnen\";\ndaqTableMapping[\"stadtFlurstuecke\"] = \"stadt_flurstuecke\";\n\nexport const searchForFeatures = async (db, daqKeys, geom) => {\n  let hits = [];\n  const geomBounds = getBoundsFromArea(geom);\n  const ansprechpartner = db.table(\"anprechp\");\n  const ansprechpartnerZustaendigkeit = db.table(\"zustaendigkeit\");\n  let trinkwasserbrunnen = null;\n  let trinkwasserbrunnenDist = null;\n  let bimsch = null;\n  let bimschDist = null;\n  const allBimsch = [];\n  const allTrinkwasserbrunnen = [];\n  const allFlurstuecke = [];\n\n  for (const key of daqKeys) {\n    const metaTable = await db.table(\"daq_meta\");\n\n    if (metaTable) {\n      const tableObjects = await metaTable.get({ name: key });\n      const otable = await db.table(key);\n\n      if (tableObjects) {\n        const serIndex = tableObjects.pol_index;\n\n        if (serIndex != null) {\n          const index = Flatbush.from(serIndex);\n          const indizes = index.search(\n            geomBounds[0][1],\n            geomBounds[0][0],\n            geomBounds[1][1],\n            geomBounds[1][0]\n          );\n\n          if (indizes != null) {\n            for (let i of indizes) {\n              const o = await otable.get(i);\n\n              if (o != null) {\n                const obj = o.data;\n                obj[\"typ\"] = key;\n                const geoj = obj.geojson;\n\n                if (booleanIntersects(geoj, geom)) {\n                  if (key === \"trinkwasserbrunnen\") {\n                    const distanceInMeters = getDistance(geom, geoj);\n                    await addAnsprechpartner(\n                      key,\n                      obj,\n                      ansprechpartner,\n                      ansprechpartnerZustaendigkeit\n                    );\n                    obj[\"abstand\"] = Math.round(distanceInMeters);\n\n                    if (\n                      trinkwasserbrunnenDist === null ||\n                      trinkwasserbrunnenDist > distanceInMeters\n                    ) {\n                      if (trinkwasserbrunnen !== null) {\n                        allTrinkwasserbrunnen.push(trinkwasserbrunnen);\n                      }\n                      trinkwasserbrunnen = obj;\n                      trinkwasserbrunnenDist = distanceInMeters;\n                    } else {\n                      allTrinkwasserbrunnen.push(obj);\n                    }\n                  } else if (key === \"bimschNrw\" || key === \"bimschWuppertal\") {\n                    const distanceInMeters = getDistance(geom, geoj);\n                    await addAnsprechpartner(\n                      key,\n                      obj,\n                      ansprechpartner,\n                      ansprechpartnerZustaendigkeit\n                    );\n                    obj[\"abstand\"] = Math.round(distanceInMeters);\n\n                    if (bimschDist === null || bimschDist > distanceInMeters) {\n                      if (bimsch !== null) {\n                        allBimsch.push(bimsch);\n                      }\n                      bimsch = obj;\n                      bimschDist = distanceInMeters;\n                    } else {\n                      allBimsch.push(obj);\n                    }\n                  } else if (key === \"stadtFlurstuecke\") {\n                    const dienststellen = obj.dienststellen.split(\"#\");\n\n                    if (dienststellen.length > 1) {\n                      const dienststellenOld = obj.dienststellen;\n                      const ansprechpartnerArray = [];\n\n                      for (let stelle of dienststellen) {\n                        obj.dienststellen = stelle;\n                        //the field ansprechpartner should not be used for the next search\n                        delete obj.ansprechpartner;\n                        await addAnsprechpartner(\n                          key,\n                          obj,\n                          ansprechpartner,\n                          ansprechpartnerZustaendigkeit\n                        );\n\n                        if (obj.ansprechpartner !== undefined) {\n                          ansprechpartnerArray.push(obj.ansprechpartner);\n                        }\n                      }\n                      obj.dienststellen = dienststellenOld;\n                      obj.ansprechpartner = ansprechpartnerArray;\n\n                      if (geom !== null && geom.geometry.type !== \"Point\") {\n                        const centerGeom = turfCenter(geom);\n                        if (booleanIntersects(geoj, centerGeom.geometry)) {\n                          obj[\"abstand\"] = 0;\n                        } else {\n                          const distanceInMeters = getDistance(geom, geoj);\n                          obj[\"abstand\"] = Math.round(distanceInMeters);\n                        }\n                      }\n\n                      allFlurstuecke.push(obj);\n                      //                      hits.push(obj);\n                    } else {\n                      await addAnsprechpartner(\n                        key,\n                        obj,\n                        ansprechpartner,\n                        ansprechpartnerZustaendigkeit\n                      );\n                      if (geom !== null && geom.geometry.type !== \"Point\") {\n                        const centerGeom = turfCenter(geom);\n                        if (booleanIntersects(geoj, centerGeom.geometry)) {\n                          obj[\"abstand\"] = 0;\n                        } else {\n                          const distanceInMeters = getDistance(geom, geoj);\n                          obj[\"abstand\"] = Math.round(distanceInMeters);\n                        }\n                      }\n\n                      allFlurstuecke.push(obj);\n                      //                      hits.push(obj);\n                    }\n                  } else {\n                    await addAnsprechpartner(\n                      key,\n                      obj,\n                      ansprechpartner,\n                      ansprechpartnerZustaendigkeit\n                    );\n\n                    hits.push(obj);\n                  }\n                  obj[\"default_name\"] = obj[nameMapping[key]];\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  if (allFlurstuecke !== null && allFlurstuecke.length > 0) {\n    allFlurstuecke.sort(compareDist);\n    Array.prototype.push.apply(hits, allFlurstuecke);\n  }\n\n  if (trinkwasserbrunnen !== null) {\n    hits.push(trinkwasserbrunnen);\n    allTrinkwasserbrunnen.sort(compareDist);\n    Array.prototype.push.apply(hits, allTrinkwasserbrunnen);\n  }\n\n  if (bimsch !== null) {\n    hits.push(bimsch);\n    allBimsch.sort(compareDist);\n    Array.prototype.push.apply(hits, allBimsch);\n  }\n\n  if (hits) {\n    hits = hits.filter((value, index, arr) => {\n      if (value.typ === \"StoerfallBetriebeKlasse2\") {\n        for (let elA1 of hits) {\n          if (elA1.typ === \"StoerfallBetriebeKlasse1\" && elA1.betrieb === value.betrieb) {\n            return false;\n          }\n        }\n\n        return true;\n      } else {\n        return true;\n      }\n    });\n  }\n\n  return hits;\n};\n\nconst compareDist = (a, b) => {\n  if (a.abstand < b.abstand) {\n    return -1;\n  } else if (a.abstand > b.abstand) {\n    return 1;\n  } else {\n    return 0;\n  }\n};\n\nexport const getDistance = (geom, geojson) => {\n  const geomCenter = turfCenter(geom);\n  const geomCenterCoords = [geomCenter.geometry.coordinates[0], geomCenter.geometry.coordinates[1]];\n  const transformedGeom = proj4(proj4.defs(\"EPSG:3857\"), proj4.defs(\"EPSG:4326\"), geomCenterCoords);\n  const brunnenCenter = turfCenter(geojson);\n  const brunnenCoords = [\n    brunnenCenter.geometry.coordinates[0],\n    brunnenCenter.geometry.coordinates[1],\n  ];\n  const transformedBrunnen = proj4(proj4.defs(\"EPSG:3857\"), proj4.defs(\"EPSG:4326\"), brunnenCoords);\n  const dist = turfDistance(transformedGeom, transformedBrunnen, { unit: \"kilometers\" });\n  //the calculated distance must be multiplied by 1.6, caused by the used longitudes/latitudes\n  const distanceInMeters = dist * 1000 * 1.6;\n\n  return distanceInMeters;\n};\n\nexport const addAnsprechpartner = async (\n  daqKey,\n  dataObject,\n  ansprechpartner,\n  ansprechpartnerZustaendigkeit\n) => {\n  const table = daqTableMapping[daqKey];\n  const keys = Object.keys(dataObject);\n  let found = false;\n\n  for (const key of keys) {\n    if (key !== \"geojson\" && dataObject[key] !== undefined && dataObject[key] !== null) {\n      const anprechreferenz = await ansprechpartnerZustaendigkeit.get({\n        tabelle: table,\n        referenz: dataObject[key],\n        referenzfeld: key,\n      });\n\n      if (anprechreferenz) {\n        const anspr = await ansprechpartner.get({ id: \"\" + anprechreferenz.data.ansprechpartner });\n\n        if (anspr) {\n          removeNullValues(anspr.data);\n          dataObject[\"ansprechpartner\"] = anspr.data;\n          found = true;\n        }\n        break;\n      }\n    }\n  }\n\n  if (found === false) {\n    const anprechreferenz = await ansprechpartnerZustaendigkeit.get({\n      tabelle: table,\n      referenz: \"null\",\n      referenzfeld: \"null\",\n    });\n\n    if (anprechreferenz) {\n      const anspr = await ansprechpartner.get({ id: \"\" + anprechreferenz.data.ansprechpartner });\n\n      if (anspr) {\n        removeNullValues(anspr.data);\n        dataObject[\"ansprechpartner\"] = anspr.data;\n      }\n    }\n  }\n\n  return dataObject;\n};\n\nexport const removeNullValues = (obj) => {\n  const keys = Object.keys(obj);\n\n  for (const key of keys) {\n    if (obj[key] === null) {\n      obj[key] = undefined;\n    }\n  }\n};\n\nexport const offlineDataAvailable = async (db, daqKeys) => {\n  let lastTime = null;\n\n  for (const key of daqKeys) {\n    const metaTable = await db.table(\"daq_meta\");\n\n    if (metaTable != null) {\n      const tableObjects = await metaTable.get({ name: key });\n\n      if (tableObjects != null) {\n        lastTime = tableObjects.time;\n      } else {\n        console.log(\"offline data for key \" + key + \" not available\");\n        return null;\n      }\n    }\n  }\n\n  return lastTime;\n};\n","import dayjs from \"dayjs\";\nimport customParseFormat from \"dayjs/plugin/customParseFormat\";\nimport localforage from \"localforage\";\nimport { useContext, useEffect, useRef, useState } from \"react\";\nimport { Button, Form, Modal } from \"react-bootstrap\";\nimport IconComp from \"react-cismap/commons/Icon\";\nimport { FeatureCollectionDispatchContext } from \"react-cismap/contexts/FeatureCollectionContextProvider\";\nimport { ResponsiveTopicMapContext } from \"react-cismap/contexts/ResponsiveTopicMapContextProvider\";\nimport { UIDispatchContext } from \"react-cismap/contexts/UIContextProvider\";\nimport { CACHE_JWT } from \"react-cismap/tools/fetching\";\nimport { appKey, daqKeys, db } from \"../App\";\nimport { offlineDataAvailable } from \"../search\";\n\ndayjs.extend(customParseFormat);\n\nconst LoginForm = ({\n  setJWT = (jwt) => {\n    console.log(\"you need to set the attribute setJWT in the <Login> component\", jwt);\n  },\n  loginInfo,\n  setLoginInfo = () => {},\n  setLoggedOut,\n}) => {\n  console.log(\"xxx loginform mounted\");\n\n  const { windowSize } = useContext(ResponsiveTopicMapContext);\n  const { setMetaInformation } = useContext(FeatureCollectionDispatchContext);\n  const { setAppMenuVisible } = useContext(UIDispatchContext);\n\n  const pwFieldRef = useRef();\n  const userFieldRef = useRef();\n  const _height = windowSize?.height || 800 - 180;\n  const modalBodyStyle = {\n    overflowY: \"auto\",\n    overflowX: \"hidden\",\n    maxHeight: _height,\n  };\n  const [user, _setUser] = useState(\"\");\n  const [pw, setPw] = useState(\"\");\n  const [cacheDataAvailable, setCacheDataAvailable] = useState(false);\n  window.localforage = localforage;\n  const setUser = (user) => {\n    // eslint-disable-next-line\n    localforage.setItem(\"@\" + appKey + \".\" + \"auth\" + \".\" + \"user\", user);\n    _setUser(user);\n  };\n  useEffect(() => {\n    setAppMenuVisible(false);\n  }, []);\n  useEffect(() => {\n    (async () => {\n      // eslint-disable-next-line\n      const userInCache = await localforage.getItem(\"@\" + appKey + \".\" + \"auth\" + \".\" + \"user\");\n      const dataValueInCache = await offlineDataAvailable(db, daqKeys);\n\n      setCacheDataAvailable(dataValueInCache !== null && dataValueInCache !== undefined);\n      if (dataValueInCache !== null && dataValueInCache !== undefined) {\n        const time = dayjs(dataValueInCache, \"YYYY-MM-DD hh:mm:ss\").toDate();\n        setMetaInformation({ time });\n      }\n      if (userInCache) {\n        setUser(userInCache);\n      }\n      if (userFieldRef?.current) {\n        userFieldRef.current.focus();\n        userFieldRef.current.select();\n      }\n    })();\n  }, [setMetaInformation]);\n\n  /*eslint no-useless-concat: \"off\"*/\n  const login = () => {\n    fetch(\"https://umweltalarm-api.cismet.de/users\", {\n      method: \"GET\",\n      headers: {\n        Authorization: \"Basic \" + btoa(user + \"@\" + \"WUNDA_BLAU\" + \":\" + pw),\n        \"Content-Type\": \"application/json\",\n      },\n    })\n      .then(function (response) {\n        if (response.status >= 200 && response.status < 300) {\n          response.json().then(function (responseWithJWT) {\n            const jwt = responseWithJWT.jwt;\n            setLoginInfo({\n              color: \"#79BD9A\",\n              text: \"Anmeldung erfolgreich. Daten werden geladen.\",\n            });\n            setTimeout(() => {\n              setJWT(jwt);\n              setLoggedOut(false);\n              setLoginInfo();\n            }, 500);\n          });\n        } else {\n          setLoginInfo({\n            color: \"#FF8048\",\n            text: \"Bei der Anmeldung ist ein Fehler aufgetreten. \",\n          });\n          setTimeout(() => {\n            setLoginInfo();\n          }, 2500);\n        }\n      })\n      .catch(function (err) {\n        setLoginInfo({ color: \"#FF3030\", text: \"Bei der Anmeldung ist ein Fehler aufgetreten.\" });\n        setTimeout(() => {\n          setLoginInfo();\n        }, 2500);\n      });\n  };\n\n  return (\n    <Modal\n      style={{\n        zIndex: 3000000000,\n      }}\n      height='100%'\n      size='l'\n      show={true}\n      //   onHide={close}\n      keyboard={false}\n    >\n      <Modal.Header>\n        <Modal.Title>\n          <div>\n            <div>\n              <IconComp name={\"user\"} /> Anmeldung\n            </div>\n          </div>\n        </Modal.Title>\n      </Modal.Header>\n      <Modal.Body style={modalBodyStyle} id='potenzialflaechen-online' key='login'>\n        <Form>\n          <Form.Group controlId='potenzialflaechen-online-login'>\n            <Form.Label>WuNDa Benutzername</Form.Label>\n            <Form.Control\n              value={user}\n              ref={userFieldRef}\n              onChange={(e) => {\n                setUser(e.target.value);\n              }}\n              onKeyPress={(event) => {\n                if (event.key === \"Enter\") {\n                  // login();\n                  if (pwFieldRef.current) {\n                    pwFieldRef.current.focus();\n                  }\n                }\n              }}\n              placeholder='Login hier eingeben'\n            />\n            {/* <Form.Text className='text-muted'>\n              We'll never share your email with anyone else.\n            </Form.Text> */}\n          </Form.Group>\n\n          <Form.Group controlId='potenzialflaechen-online-pass'>\n            <Form.Label>Passwort</Form.Label>\n            <Form.Control\n              ref={pwFieldRef}\n              value={pw}\n              onChange={(e) => {\n                setPw(e.target.value);\n              }}\n              type='password'\n              placeholder='Password'\n              onKeyPress={(event) => {\n                if (event.key === \"Enter\") {\n                  login();\n                }\n              }}\n            />\n          </Form.Group>\n          <div\n            style={{\n              width: \"100%\",\n              display: \"flex\",\n              alignItems: \"baseline\",\n              flexDirection: \"row\",\n              justifyContent: \"space-between\",\n            }}\n          >\n            {loginInfo?.text && (\n              <div style={{ margin: 10, color: loginInfo?.color || \"black\", maxWidth: 200 }}>\n                <b>{loginInfo?.text}</b>\n              </div>\n            )}\n            <div style={{ flexShrink: 100 }}></div>\n            <div>\n              {cacheDataAvailable === true && (\n                <Button\n                  onClick={(e) => {\n                    setLoginInfo({\n                      color: \"#79BD9A\",\n                      text: \"Alte Daten werden aus dem Cache übernommen.\",\n                    });\n                    setTimeout(() => {\n                      setJWT(CACHE_JWT);\n                      setLoggedOut(false);\n                      setLoginInfo();\n                    }, 500);\n                  }}\n                  style={{ margin: 5, marginTop: 30 }}\n                  variant='secondary'\n                >\n                  Offline arbeiten\n                </Button>\n              )}\n              <Button\n                onClick={(e) => {\n                  login();\n                }}\n                style={{ margin: 5, marginTop: 30 }}\n                variant='primary'\n              >\n                Anmeldung\n              </Button>\n            </div>\n          </div>\n        </Form>\n      </Modal.Body>\n    </Modal>\n  );\n};\nexport default LoginForm;\n","import { useContext } from \"react\";\nimport { ResponsiveTopicMapContext } from \"react-cismap/contexts/ResponsiveTopicMapContextProvider\";\nimport { FeatureCollectionContext } from \"react-cismap/contexts/FeatureCollectionContextProvider\";\n\nimport { CACHE_JWT } from \"react-cismap/tools/fetching\";\n\nconst Title = ({ logout, jwt }) => {\n  const { windowSize } = useContext(ResponsiveTopicMapContext);\n  const { metaInformation } = useContext(FeatureCollectionContext);\n  let dateInfo;\n  if (metaInformation) {\n    const t = metaInformation.time;\n    const d = new Date(t);\n    dateInfo = d.toLocaleString();\n  }\n\n  let secondaryInfo, jwtPayload, actiontext;\n  if (jwt === CACHE_JWT) {\n    secondaryInfo = \"Daten aus dem Cache\"; //;+ metaInformation.time;\n    actiontext = \"anmelden und Daten aktualisieren\";\n  } else {\n    try {\n      jwtPayload = atob(jwt.split(\".\")[1]);\n      secondaryInfo = JSON.parse(jwtPayload).sub;\n      actiontext = \"abmelden\";\n    } catch (e) {}\n  }\n  /*eslint jsx-a11y/anchor-is-valid: \"off\"*/\n  const titleContent = (\n    <div>\n      <b>Umweltalarm</b> ({secondaryInfo + (dateInfo !== undefined ? \", \" + dateInfo : \"\")})\n      <div style={{ float: \"right\", paddingRight: 10 }}>\n        <a\n          style={{ color: \"#337ab7\" }}\n          onClick={() => {\n            logout();\n          }}\n        >\n          {/* <FontAwesomeIcon icon={faRandom} style={{ marginRight: 5 }} /> */}\n          {actiontext}\n        </a>\n      </div>\n    </div>\n  );\n\n  return (\n    <table\n      style={{\n        width: (windowSize?.width || 300) - 54 - 12 - 38 - 12 + \"px\",\n        height: \"30px\",\n        position: \"absolute\",\n        left: 54,\n        top: 12,\n        zIndex: 555,\n      }}\n    >\n      <tbody>\n        <tr>\n          <td\n            style={{\n              textAlign: \"center\",\n              verticalAlign: \"middle\",\n              background: \"#ffffff\",\n              color: \"black\",\n              opacity: \"0.9\",\n              paddingLeft: \"10px\",\n            }}\n          >\n            {titleContent}\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  );\n};\n\nexport default Title;\n","import {\n  faCity,\n  faExclamationCircle,\n  faFaucet,\n  faHandHoldingWater,\n  faIndustry,\n  faMap,\n  faTree,\n} from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { useContext } from \"react\";\nimport { Button } from \"react-bootstrap\";\nimport { UIContext, UIDispatchContext } from \"react-cismap/contexts/UIContextProvider\";\nimport ResponsiveInfoBox from \"react-cismap/topicmaps/ResponsiveInfoBox\";\nimport Loadable from \"react-loading-overlay\";\n\nexport const modes = {\n  WINDOW: \"WINDOW\",\n  CENTER: \"CENTER\",\n};\nconst InfoBox = ({ hits, mode, setFeatureCollectionVisible, isFeatureCollectionVisible }) => {\n  const { collapsedInfoBox } = useContext(UIContext);\n  const { setCollapsedInfoBox, setSecondaryInfoVisible } = useContext(UIDispatchContext);\n  var hitsObject = {};\n  var flurstueckDienstStellenAnzahl = 0;\n\n  if (Array.isArray(hits)) {\n    for (var el of hits) {\n      switch (el.typ) {\n        case \"trinkwasserbrunnen\":\n          if (hitsObject.brunnen === undefined) {\n            hitsObject.brunnen = [];\n          }\n          hitsObject.brunnen.push(el);\n          break;\n        case \"bimschNrw\":\n        case \"bimschWuppertal\":\n          if (hitsObject.bimsch === undefined) {\n            hitsObject.bimsch = [];\n          }\n          hitsObject.bimsch.push(el);\n          break;\n        case \"strassenmeisterei\":\n          if (hitsObject.strassenmeisterei === undefined) {\n            hitsObject.strassenmeisterei = [];\n          }\n          hitsObject.strassenmeisterei.push(el);\n          break;\n        case \"naturschutzgebiete\":\n        case \"landschaftsschutzgebiete\":\n          if (hitsObject.schutzgebiete === undefined) {\n            hitsObject.schutzgebiete = [];\n          }\n          hitsObject.schutzgebiete.push(el);\n          break;\n        case \"autobahnmeisterei\":\n          if (hitsObject.autobahnmeisterei === undefined) {\n            hitsObject.autobahnmeisterei = [];\n          }\n          hitsObject.autobahnmeisterei.push(el);\n          break;\n        case \"wasserschutzgebiete\":\n          if (hitsObject.wasserschutzgebiete === undefined) {\n            hitsObject.wasserschutzgebiete = [];\n          }\n          hitsObject.wasserschutzgebiete.push(el);\n          break;\n        case \"wasserverbaende\":\n          if (hitsObject.verbaende === undefined) {\n            hitsObject.verbaende = [];\n          }\n          hitsObject.verbaende.push(el);\n          break;\n        case \"StoerfallBetriebeKlasse1\":\n        case \"StoerfallBetriebeKlasse2\":\n          if (hitsObject.stoerfallbetriebe === undefined) {\n            hitsObject.stoerfallbetriebe = [];\n          }\n          hitsObject.stoerfallbetriebe.push(el);\n          break;\n        case \"stadtFlurstuecke\":\n          if (hitsObject.stadtFlurstuecke === undefined) {\n            hitsObject.stadtFlurstuecke = [];\n          }\n          flurstueckDienstStellenAnzahl =\n            flurstueckDienstStellenAnzahl + el.dienststellen.split(\"#\").length;\n          hitsObject.stadtFlurstuecke.push(el);\n          break;\n        default:\n      }\n    }\n  }\n\n  const header = (\n    <table style={{ width: \"100%\" }}>\n      <tbody>\n        <tr>\n          <td\n            style={{\n              textAlign: \"left\",\n              verticalAlign: \"top\",\n              background: \"grey\",\n              color: \"black\",\n              opacity: \"0.9\",\n              paddingLeft: \"4px\",\n              paddingTop: \"0px\",\n              paddingBottom: \"0px\",\n            }}\n          >\n            <span>\n              {\" \"}\n              Analyseergebnis {mode === modes.CENTER ? \"(Fadenkreuz)\" : \"(Kartenfenster)\"}:{\" \"}\n              {Array.isArray(hits) ? hits.length : \"-\"} Treffer\n            </span>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  );\n\n  let fontSize = 30;\n  let activeStyle = { border: 0, borderStyle: \"solid\", fontSize, textAlign: \"center\", flexGrow: 1 };\n  let inactiveStyle = {\n    border: 0,\n    borderStyle: \"solid\",\n    fontSize,\n    textAlign: \"center\",\n    color: \"#dddddd\",\n    flexGrow: 1,\n  };\n  let subtextStyle = { fontSize: 12, minHeight: \"18px\" };\n\n  let gridStyle = {\n    display: \"grid\",\n    gridGap: \"5px\",\n    gridTemplateColumns: \"repeat(3, 1fr)\",\n    verticalAlign: \"center\",\n  };\n  if (collapsedInfoBox === true) {\n    fontSize = 23;\n    subtextStyle = { fontSize: 9, minHeight: \"15px\" };\n    gridStyle = {\n      display: \"flex\",\n      flexDirection: \"row\",\n      flexWrap: \"nowrap\",\n      justifyContent: \"center\",\n      verticalAlign: \"center\",\n      alignContent: \"space-around\",\n    };\n  }\n\n  let symbols = (\n    <div\n      onClick={() => {\n        setSecondaryInfoVisible(true);\n      }}\n    >\n      <Loadable active={hits === undefined} spinner text={\"Suchen\"}>\n        <div style={gridStyle}>\n          {/* Trinkwasserbrunnen */}\n          <div\n            title='Trinkwasserbrunnen'\n            style={hitsObject?.brunnen !== undefined ? activeStyle : inactiveStyle}\n          >\n            <FontAwesomeIcon style={{ fontSize }} icon={faFaucet} />\n            <div style={subtextStyle}>\n              {hitsObject?.brunnen !== undefined\n                ? hitsObject?.brunnen[0].abstand +\n                  \" m\" +\n                  (hitsObject?.brunnen.length > 1\n                    ? \" (+\" + (hitsObject?.brunnen.length - 1) + \")\"\n                    : \"\")\n                : \"\"}\n            </div>\n          </div>\n          {/* Autobahnmeisterei */}\n          {/* <div style={hitsObject?.autobahnmeisterei !== undefined ? activeStyle : inactiveStyle}>\n            <FontAwesomeIcon style={{ fontSize }} icon={faRoad} />\n            <div style={subtextStyle}>{(hitsObject?.autobahnmeisterei !== undefined ? hitsObject?.autobahnmeisterei[0].default_name : '')}</div>\n          </div> */}\n          {/* Straßenmeisterei */}\n          {/* <div style={hitsObject?.strassenmeisterei !== undefined ? activeStyle : inactiveStyle}>\n            <FontAwesomeIcon style={{ fontSize }} icon={faRoad} />\n            <div style={subtextStyle}>{(hitsObject?.strassenmeisterei !== undefined ? hitsObject?.strassenmeisterei[0].default_name : '')}</div>\n          </div> */}\n          {/* BIMSchG */}\n          <div\n            title='BImschG-Anlagen'\n            style={hitsObject?.bimsch !== undefined ? activeStyle : inactiveStyle}\n          >\n            <FontAwesomeIcon style={{ fontSize }} icon={faIndustry} />\n            <div style={subtextStyle}>\n              {hitsObject?.bimsch !== undefined\n                ? (hitsObject?.bimsch[0].typ === \"bimschNrw\" ? \"BRD - \" : \"UIB - \") +\n                  hitsObject?.bimsch[0].abstand +\n                  \" m\" +\n                  (hitsObject?.bimsch.length > 1\n                    ? \" (+\" + (hitsObject?.bimsch.length - 1) + \")\"\n                    : \"\")\n                : \"\"}\n            </div>\n          </div>\n          {/* Wasserschutzgebiete */}\n          <div\n            title='Wasserschutzgebiete'\n            style={hitsObject?.wasserschutzgebiete !== undefined ? activeStyle : inactiveStyle}\n          >\n            <FontAwesomeIcon style={{ fontSize }} icon={faHandHoldingWater} />\n            <div style={subtextStyle}>\n              {hitsObject?.wasserschutzgebiete !== undefined\n                ? \"Zone: \" +\n                  hitsObject?.wasserschutzgebiete[0].default_name +\n                  (hitsObject?.wasserschutzgebiete.length > 1\n                    ? \" (+\" + (hitsObject?.wasserschutzgebiete.length - 1) + \")\"\n                    : \"\")\n                : \"\"}\n            </div>\n          </div>\n          {/* Verbände */}\n          {/* <div style={hitsObject?.verbaende !== undefined ? activeStyle : inactiveStyle}>\n            <FontAwesomeIcon style={{ fontSize }} icon={faWater} />\n            <div style={subtextStyle}>\n              {hitsObject?.verbaende !== undefined ? hitsObject?.verbaende[0].default_name : \"\"}\n            </div>\n          </div> */}\n          {/* Störfallbetriebe */}\n          <div\n            title='Störfallbetriebe'\n            style={hitsObject?.stoerfallbetriebe !== undefined ? activeStyle : inactiveStyle}\n          >\n            <FontAwesomeIcon style={{ fontSize }} icon={faExclamationCircle} />\n            <div style={subtextStyle}>\n              {hitsObject?.stoerfallbetriebe !== undefined\n                ? hitsObject?.stoerfallbetriebe[0].default_name +\n                  (hitsObject?.stoerfallbetriebe[0].typ === \"StoerfallBetriebeKlasse1\"\n                    ? \"-A1\"\n                    : \"-A2\") +\n                  (hitsObject?.stoerfallbetriebe.length > 1\n                    ? \" (+\" + (hitsObject?.stoerfallbetriebe.length - 1) + \")\"\n                    : \"\")\n                : \"\"}\n            </div>\n          </div>\n          {/* städt. Flurstücke */}\n          <div\n            title='Städtische Flurstücke'\n            style={hitsObject?.stadtFlurstuecke !== undefined ? activeStyle : inactiveStyle}\n          >\n            <FontAwesomeIcon style={{ fontSize }} icon={faCity} />\n            <div style={subtextStyle}>\n              {hitsObject?.stadtFlurstuecke !== undefined\n                ? hitsObject?.stadtFlurstuecke[0].default_name.split(\"#\")[0] +\n                  (hitsObject?.stadtFlurstuecke.length > 1\n                    ? \" (+\" + (hitsObject?.stadtFlurstuecke.length - 1) + \")\"\n                    : \"\")\n                : //                ? hitsObject?.stadtFlurstuecke[0].default_name + (hitsObject?.stadtFlurstuecke.length > 1 ? ' (+' + (hitsObject?.stadtFlurstuecke.length - 1) + ')' : '')\n                  \"\"}\n            </div>\n          </div>\n          {/* Landschafts und Naturschutzgebiete */}\n          <div\n            title='Landschafts- und Naturschutzgebiete'\n            style={hitsObject?.schutzgebiete !== undefined ? activeStyle : inactiveStyle}\n          >\n            <FontAwesomeIcon style={{ fontSize }} icon={faTree} />\n            <div style={subtextStyle}>\n              {hitsObject?.schutzgebiete !== undefined\n                ? (hitsObject?.schutzgebiete[0].typ === \"naturschutzgebiete\" ? \"NSG\" : \"LSG\") +\n                  (hitsObject?.schutzgebiete.length > 1\n                    ? \" (+\" + (hitsObject?.schutzgebiete.length - 1) + \")\"\n                    : \"\")\n                : \"\"}\n            </div>\n          </div>\n        </div>\n      </Loadable>\n    </div>\n  );\n  return (\n    <ResponsiveInfoBox\n      panelClick={() => {}}\n      pixelwidth={300}\n      header={header}\n      collapsedInfoBox={collapsedInfoBox}\n      setCollapsedInfoBox={setCollapsedInfoBox}\n      isCollapsible={true}\n      collapsibleStyle={{ paddingLeft: 0 }}\n      handleResponsiveDesign={true}\n      infoStyle={{ padding: \"0px\" }}\n      alwaysVisibleDiv={collapsedInfoBox ? symbols : null}\n      collapsibleDiv={!collapsedInfoBox ? symbols : null}\n      fixedRow={true}\n      secondaryInfoBoxElements={[\n        <div>\n          <Button\n            variant={isFeatureCollectionVisible ? \"success\" : \"secondary\"}\n            title={isFeatureCollectionVisible ? \"aus Karte ausblenden\" : \"in Karte anzeigen\"}\n            style={{ marginBottom: 5 }}\n            onClick={() => {\n              setFeatureCollectionVisible(!isFeatureCollectionVisible);\n            }}\n          >\n            <FontAwesomeIcon icon={faMap} />\n          </Button>\n        </div>,\n      ]}\n    />\n  );\n};\nexport default InfoBox;\n","const APPERSION = \"1.0.4\";\nconst APPHASH = \"#9519f9887b1f023c319e716632c1ecbfb8450b49\";\n\nexport const getApplicationVersion = () => {\n  /*eslint-disable no-useless-concat*/\n  if (APPERSION === \"%APPLICATION\" + \"_\" + \"VERSION%\") {\n    return \"dev-hot-reload\";\n  } else {\n    return APPERSION;\n  }\n};\nexport const getApplicationHash = () => {\n  if (APPHASH === \"%APPLICATION\" + \"_\" + \"HASH%\") {\n    return \"#dev-hot-reload\";\n  } else {\n    return APPHASH;\n  }\n};\n","import { useContext } from \"react\";\nimport { UIDispatchContext } from \"react-cismap/contexts/UIContextProvider\";\nimport { version as reactCismapVersion } from \"react-cismap/meta\";\nimport { scroller } from \"react-scroll\";\nimport { getApplicationVersion } from \"../version\";\n\nconst Footer = () => {\n  const { setAppMenuActiveMenuSection } = useContext(UIDispatchContext);\n  /*eslint jsx-a11y/anchor-is-valid: \"off\"*/\n\n  return (\n    <div style={{ fontSize: \"11px\" }}>\n      <b>Hintergrundkarten</b>: Stadtkarte 2.0 © RVR | True Orthophoto 2020 © Stadt Wuppertal |\n      Openmaptiles basierte Vectorkarte (hosted by cismet){\" \"}\n      <a\n        className='pleaseRenderAsLink'\n        onClick={() => {\n          setAppMenuActiveMenuSection(\"help\");\n          scroller.scrollTo(\"Datengrundlage\", { containerId: \"myMenu\" });\n        }}\n      >\n        (Details und Nutzungsbedingungen)\n      </a>\n      <br />\n      <div>\n        <b>\n          {document.title} v{getApplicationVersion()}\n        </b>\n        :{\" \"}\n        <a href='https://cismet.de/' target='_cismet'>\n          cismet GmbH\n        </a>{\" \"}\n        auf Basis von{\" \"}\n        <a href='http://leafletjs.com/' target='_more'>\n          Leaflet\n        </a>{\" \"}\n        und{\" \"}\n        <a href='https://cismet.de/#refs' target='_cismet'>\n          cids | react-cismap v{reactCismapVersion}\n        </a>{\" \"}\n        |{\" \"}\n        <a\n          target='_blank'\n          rel='noopener noreferrer'\n          href='https://cismet.de/datenschutzerklaerung.html'\n        >\n          Datenschutzerklärung (Privacy Policy)\n        </a>\n      </div>\n    </div>\n  );\n};\nexport default Footer;\n","import { getSimpleHelpForTM } from \"react-cismap/tools/uiHelper\";\nimport ConfigurableDocBlocks from \"react-cismap/topicmaps/ConfigurableDocBlocks\";\nimport DefaultSettingsPanel from \"react-cismap/topicmaps/menu/DefaultSettingsPanel\";\nimport ModalApplicationMenu from \"react-cismap/topicmaps/menu/ModalApplicationMenu\";\nimport Section from \"react-cismap/topicmaps/menu/Section\";\nimport MenuFooter from \"./MenuFooter\";\n\nconst MyMenu = () => {\n  const simpleHelp = undefined;\n  return (\n    <ModalApplicationMenu\n      menuIcon={\"bars\"}\n      menuTitle={\"Einstellungen und Kompaktanleitung\"}\n      menuIntroduction={\n        <span>\n          Über <strong>Einstellungen</strong> können Sie die Darstellung der Hintergrundkarte und\n          der Objekte an Ihre Vorlieben anpassen. Wählen Sie <strong>Kompaktanleitung</strong> für\n          detailliertere Bedienungsinformationen.\n        </span>\n      }\n      menuSections={[\n        <DefaultSettingsPanel\n          key='settings'\n          skipFilterTitleSettings={true}\n          skipClusteringSettings={true}\n          skipSymbolsizeSetting={true}\n          previewMapPosition='lat=51.26237138174926&lng=7.236986160278321&zoom=16'\n        />,\n        <Section\n          key='legend'\n          sectionKey='legend'\n          sectionTitle='Legende der Fachdaten'\n          sectionBsStyle='info'\n          sectionContent={\n            <div>\n              <ul style={{ listStyleType: \"none\" }}>\n                <li>\n                  <img\n                    style={{ padding: 5, marginRight: 15 }}\n                    width='50px'\n                    alt='Legendenbild'\n                    src={process.env.PUBLIC_URL + \"/images/Legende_Wupperverband.png\"}\n                  ></img>\n                  Gewässer Wupperverband\n                </li>\n                <li>\n                  <img\n                    style={{ padding: 5, marginRight: 15 }}\n                    width='50px'\n                    alt='Legendenbild'\n                    src={process.env.PUBLIC_URL + \"/images/Legende_BRWasserverband.png\"}\n                  ></img>\n                  Gewässer Bergisch-Rheinischer Wasserverband / Ruhrverband\n                </li>\n                <li>\n                  <img\n                    style={{ padding: 5, marginRight: 15 }}\n                    width='50px'\n                    alt='Legendenbild'\n                    src={process.env.PUBLIC_URL + \"/images/Legende_Verrohrung.png\"}\n                  ></img>\n                  Gewässerverrohrungen\n                </li>\n                <li>\n                  <img\n                    style={{ padding: 5, marginRight: 15 }}\n                    width='50px'\n                    alt='Legendenbild'\n                    src={process.env.PUBLIC_URL + \"/images/Legende_Schmutzkanal.png\"}\n                  ></img>\n                  Schmutzwasserkanal\n                </li>\n                <li>\n                  <img\n                    style={{ padding: 5, marginRight: 15 }}\n                    width='50px'\n                    alt='Legendenbild'\n                    src={process.env.PUBLIC_URL + \"/images/Legende_Regenkanal.png\"}\n                  ></img>\n                  Regenwasserkanal\n                </li>\n                <li>\n                  <img\n                    style={{ padding: 5, marginRight: 15 }}\n                    width='50px'\n                    alt='Legendenbild'\n                    src={process.env.PUBLIC_URL + \"/images/Legende_Mischkanal.png\"}\n                  ></img>\n                  Mischwasserkanal\n                </li>\n                <li>\n                  <img\n                    style={{ padding: 5, marginRight: 15 }}\n                    width='50px'\n                    alt='Legendenbild'\n                    src={process.env.PUBLIC_URL + \"/images/Legende_Privatkanal.png\"}\n                  ></img>\n                  Privatkanal\n                </li>\n                <li>\n                  <img\n                    style={{ padding: 5, marginRight: 15 }}\n                    width='50px'\n                    alt='Legendenbild'\n                    src={process.env.PUBLIC_URL + \"/images/Legende_Fliessrichtung.png\"}\n                  ></img>\n                  Fließrichtungspfeil (jeweils in der Farbe des zugehörigen Kanalnetzes)\n                </li>\n                <li>\n                  <img\n                    style={{ padding: 5, marginRight: 15 }}\n                    width='50px'\n                    alt='Legendenbild'\n                    src={process.env.PUBLIC_URL + \"/images/Legende_Schachtdeckel.png\"}\n                  ></img>\n                  Schachtdeckel (jeweils in der Farbe des zugehörigen Kanalnetzes)\n                </li>\n                <li>\n                  <img\n                    style={{ padding: 5, margin: 10, marginRight: 24, marginTop: 10 }}\n                    width='30px'\n                    alt='Legendenbild'\n                    src={process.env.PUBLIC_URL + \"/images/Legende_Trinkwasserbrunnen.png\"}\n                  ></img>\n                  Trinkwasserbrunnen\n                </li>\n              </ul>\n            </div>\n          }\n        />,\n        <Section\n          key='help'\n          sectionKey='help'\n          sectionTitle='Kompaktanleitung'\n          sectionBsStyle='default'\n          sectionContent={\n            <ConfigurableDocBlocks configs={getSimpleHelpForTM(document.title, simpleHelp)} />\n          }\n        />,\n      ]}\n      menuFooter={<MenuFooter />}\n    />\n  );\n};\nexport default MyMenu;\n","import React, { useContext } from \"react\";\nimport IconLink from \"react-cismap/commons/IconLink\";\nimport { TopicMapContext } from \"react-cismap/contexts/TopicMapContextProvider\";\nimport { version as reactCismapVersion } from \"react-cismap/meta\";\nimport SecondaryInfo from \"react-cismap/topicmaps/SecondaryInfo\";\nimport SecondaryInfoPanelSection from \"react-cismap/topicmaps/SecondaryInfoPanelSection\";\nimport { getApplicationVersion } from \"../version\";\n\nconst objectifyHits = (hits) => {\n  const hitObject = {};\n\n  // const testAnsprechpartner = {\n  //   organisation: \"cismet GmbH\",\n  //   name: \"Thorsten Hell\",\n  //   email: \"th@cismet.de\",\n  //   tel: \"0681 965901 20\",\n  //   bemerkung: \"nur zum testen\",\n  // };\n  if (hits) {\n    for (const hit of hits) {\n      //      hit.ansprechpartner = testAnsprechpartner;\n      if (hit.ansprechpartner === undefined) {\n        hit.ansprechpartner = { firma: \"\", name: \"\" };\n      }\n      if (hitObject[hit.typ]) {\n        hitObject[hit.typ].push(hit);\n      } else {\n        hitObject[hit.typ] = [hit];\n      }\n    }\n  }\n  return hitObject;\n};\n\nconst footer = (\n  <div style={{ fontSize: \"11px\" }}>\n    <div>\n      <b>\n        {document.title} v{getApplicationVersion()}\n      </b>\n      :{\" \"}\n      <a href='https://cismet.de/' target='_cismet'>\n        cismet GmbH\n      </a>{\" \"}\n      auf Basis von{\" \"}\n      <a href='http://leafletjs.com/' target='_more'>\n        Leaflet\n      </a>{\" \"}\n      und{\" \"}\n      <a href='https://cismet.de/#refs' target='_cismet'>\n        cids | react-cismap v{reactCismapVersion}\n      </a>{\" \"}\n      |{\" \"}\n      <a\n        target='_blank'\n        rel='noopener noreferrer'\n        href='https://cismet.de/datenschutzerklaerung.html'\n      >\n        Datenschutzerklärung (Privacy Policy)\n      </a>\n    </div>\n  </div>\n);\n\nconst getAnsprechpartnerLinks = (ansprechpartner) => {\n  let links = [];\n  const keyPostfix = +JSON.stringify(ansprechpartner);\n  if (ansprechpartner.tel) {\n    links.push(\n      <span key={`span.tel` + keyPostfix} style={{ padding: 4 }}>\n        <IconLink\n          key={`IconLink.tel` + keyPostfix}\n          tooltip='Ansprechpartner Anrufen'\n          href={\"tel:\" + ansprechpartner.tel}\n          iconname='phone'\n        />\n      </span>\n    );\n  }\n  if (ansprechpartner.email) {\n    links.push(\n      <span key={`span.email` + keyPostfix} style={{ padding: 4 }}>\n        <IconLink\n          key={`IconLink.email` + keyPostfix}\n          tooltip='E-Mail an Ansprechpartner schreiben'\n          href={\"mailto:\" + ansprechpartner.email}\n          iconname='envelope-square'\n          target='_blank'\n        />\n      </span>\n    );\n  }\n  if (ansprechpartner.url) {\n    links.push(\n      <span key={`span.web` + keyPostfix} style={{ padding: 4 }}>\n        <IconLink\n          key={`IconLink.web` + keyPostfix}\n          tooltip='Webseite'\n          href={ansprechpartner.url}\n          target='_blank'\n          iconname='external-link-square'\n        />\n      </span>\n    );\n  }\n  return links;\n};\n\nconst getAnsprechpartner = (ansprechpartner) => {\n  if (Array.isArray(ansprechpartner)) {\n    return (\n      <div>\n        {ansprechpartner.map((value, index) => {\n          return (\n            <div key={\"ansprech_\" + index}>\n              {index > 0 && <br></br>}\n              {/* <div style={{paddingLeft: \"auto\", paddingRight: \"auto\"}}>\n            <b>Ansprechpartner</b>\n          </div> */}\n              <div\n                style={{\n                  paddingLeft: 10,\n                  paddingRight: 10,\n                  float: \"right\",\n                  paddingBottom: \"5px\",\n                }}\n              >\n                {getAnsprechpartnerLinks(value)}\n              </div>\n              <div>{value.firma}</div>\n              <div>{value.name}</div>\n              <div>{value.bemerkung}</div>\n            </div>\n          );\n        })}\n      </div>\n    );\n  } else {\n    return (\n      <div>\n        {/* <div style={{paddingLeft: \"auto\", paddingRight: \"auto\"}}>\n            <b>Ansprechpartner</b>\n          </div> */}\n        <div\n          style={{\n            paddingLeft: 10,\n            paddingRight: 10,\n            float: \"right\",\n            paddingBottom: \"5px\",\n          }}\n        >\n          {getAnsprechpartnerLinks(ansprechpartner)}\n        </div>\n        <div>{ansprechpartner.firma}</div>\n        <div>{ansprechpartner.name}</div>\n        <div>{ansprechpartner.bemerkung}</div>\n      </div>\n    );\n  }\n};\n\nconst getDienststellen = (dienststellen, ansprechpartner) => {\n  var dienststellenArray = dienststellen.split(\"#\");\n\n  return (\n    <span>\n      {dienststellenArray.map((value, index) => {\n        var styleParam =\n          value === ansprechpartner?.firma.trim() && dienststellenArray.length > 1\n            ? { borderBottom: \"1px solid black\" }\n            : {};\n\n        return (\n          <span key={\"dienstst.span.\" + index} style={styleParam}>\n            {index > 0 ? \", \" : \"\"}\n            {value}\n          </span>\n        );\n      })}\n    </span>\n  );\n};\n\nconst getSeparator = (name) => {\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        height: \"12px\",\n        borderBottom: \"1px solid #eeeeee\",\n        textAlign: \"center\",\n        marginBottom: \"15px\",\n        marginTop: \"5px\",\n      }}\n    >\n      <span\n        style={{ fontSize: \"16px\", backgroundColor: \"#FFFFFF\", xcolor: \"#aaa\", padding: \"0 10px\" }}\n      >\n        {name}\n      </span>\n    </div>\n  );\n};\n\nconst InfoPanel = ({ hits }) => {\n  const { history } = useContext(TopicMapContext);\n  const lat = new URLSearchParams(history.location.search).get(\"lat\");\n  const long = new URLSearchParams(history.location.search).get(\"lng\");\n  const showRawData = new URLSearchParams(history.location.search).get(\"showRawData\") !== null;\n\n  const hitObject = objectifyHits(hits);\n\n  if (hits !== undefined) {\n    const subSections = [];\n\n    const display = (desc, value, valFunc) => {\n      if (value && valFunc === undefined && Array.isArray(value) === false) {\n        return (\n          <div>\n            <b>{desc}:</b> {value}\n          </div>\n        );\n      } else if (value && valFunc === undefined && Array.isArray(value) === true) {\n        return (\n          <div>\n            <b>{desc}:</b> {value.join(\", \")}\n          </div>\n        );\n      } else if (value && valFunc !== undefined) {\n        return (\n          <div>\n            <b>{desc}:</b> {valFunc(value)}\n          </div>\n        );\n      }\n    };\n\n    if (hits !== undefined) {\n      if (\n        hitObject.wasserverbaende ||\n        hitObject.autobahnmeisterei ||\n        hitObject.strassenmeisterei ||\n        hitObject.stadtFlurstuecke\n      ) {\n        subSections.push(\n          <SecondaryInfoPanelSection\n            key={\"standort\" + hitObject.id}\n            bsStyle='success'\n            header={\"Zuständigkeiten\"}\n          >\n            {hitObject.wasserverbaende && getSeparator(\"Wasserverband\")}\n\n            {hitObject.wasserverbaende &&\n              hitObject.wasserverbaende.map((value, index) => {\n                return (\n                  <div key={\"wasserverbaende_\" + index}>\n                    {value.ansprechpartner && getAnsprechpartner(value.ansprechpartner)}\n                  </div>\n                );\n              })}\n\n            {hitObject.autobahnmeisterei && getSeparator(\"Autobahnmeisterei\")}\n            {/* mehrere möglich*/}\n            {hitObject.autobahnmeisterei &&\n              hitObject.autobahnmeisterei.map((value, index) => {\n                return (\n                  <div key={\"autm_\" + index}>\n                    {index > 0 && <br></br>}\n                    {value.ansprechpartner && getAnsprechpartner(value.ansprechpartner)}\n                  </div>\n                );\n              })}\n\n            {hitObject.strassenmeisterei && getSeparator(\"Straßenmeisterei\")}\n            {hitObject.strassenmeisterei && (\n              <div>\n                {hitObject.strassenmeisterei[0].ansprechpartner &&\n                  getAnsprechpartner(hitObject.strassenmeisterei[0].ansprechpartner)}\n              </div>\n            )}\n\n            {hitObject.stadtFlurstuecke && getSeparator(\"Stadt Wuppertal\")}\n            {hitObject.stadtFlurstuecke && hitObject.stadtFlurstuecke.length > 1 && (\n              <div>\n                <div>\n                  Es wurden {hitObject.stadtFlurstuecke.length} Flurstücke gefunden. Nachfolgend\n                  wird das Flurstück mit dem geringsten Abstand zum Fadenkreuz angezeigt.\n                </div>\n                <br></br>\n                <div>\n                  <div>\n                    <b>Flurstück: </b>\n                    {hitObject.stadtFlurstuecke[0].flurstueck}\n                  </div>\n                  <div>\n                    {hitObject.stadtFlurstuecke[0].dienststellen.split(\"#\").length > 1 && (\n                      <b>Dienststellen: </b>\n                    )}\n                    {hitObject.stadtFlurstuecke[0].dienststellen.split(\"#\").length <= 1 && (\n                      <b>Dienststelle: </b>\n                    )}\n                    {getDienststellen(\n                      hitObject.stadtFlurstuecke[0].dienststellen,\n                      Array.isArray(hitObject.stadtFlurstuecke[0].ansprechpartner)\n                        ? hitObject.stadtFlurstuecke[0].ansprechpartner[0]\n                        : hitObject.stadtFlurstuecke[0].ansprechpartner\n                    )}\n                    {/* {value.dienststellen.replace('#', ', ')} */}\n                  </div>\n                  <br />\n                  {hitObject.stadtFlurstuecke[0].ansprechpartner &&\n                    getAnsprechpartner(\n                      Array.isArray(hitObject.stadtFlurstuecke[0].ansprechpartner)\n                        ? hitObject.stadtFlurstuecke[0].ansprechpartner[0]\n                        : hitObject.stadtFlurstuecke[0].ansprechpartner\n                    )}\n                </div>\n              </div>\n            )}\n            {hitObject.stadtFlurstuecke &&\n              hitObject.stadtFlurstuecke.length === 1 &&\n              hitObject.stadtFlurstuecke.map((value, index) => {\n                return (\n                  <div key={\"stadtFlurstuecke_\" + index}>\n                    {index > 0 && <br></br>}\n                    <div>\n                      <b>Flurstück: </b>\n                      {value.flurstueck}\n                    </div>\n                    <div>\n                      {value.dienststellen.split(\"#\").length > 1 && <b>Dienststellen: </b>}\n                      {value.dienststellen.split(\"#\").length <= 1 && <b>Dienststelle: </b>}\n                      {getDienststellen(\n                        value.dienststellen,\n                        Array.isArray(value.ansprechpartner)\n                          ? value.ansprechpartner[0]\n                          : value.ansprechpartner\n                      )}\n                      {/* {value.dienststellen.replace('#', ', ')} */}\n                    </div>\n                    <br />\n                    {value.ansprechpartner &&\n                      getAnsprechpartner(\n                        Array.isArray(value.ansprechpartner)\n                          ? value.ansprechpartner[0]\n                          : value.ansprechpartner\n                      )}\n                  </div>\n                );\n              })}\n          </SecondaryInfoPanelSection>\n        );\n      }\n\n      if (\n        hitObject.trinkwasserbrunnen ||\n        hitObject.bimschWuppertal ||\n        hitObject.bimschNrw ||\n        hitObject.wasserschutzgebiete ||\n        hitObject.naturschutzgebiete ||\n        hitObject.landschaftsschutzgebiete ||\n        hitObject.StoerfallBetriebeKlasse1 ||\n        hitObject.StoerfallBetriebeKlasse2\n      ) {\n        subSections.push(\n          <SecondaryInfoPanelSection\n            key='standort'\n            bsStyle='primary'\n            header={\"Schutzgebiete und Anlagen\"}\n          >\n            {hitObject.trinkwasserbrunnen && getSeparator(\"Trinkwasserbrunnen\")}\n\n            {hitObject.trinkwasserbrunnen &&\n              hitObject.trinkwasserbrunnen.map((value, index) => {\n                return (\n                  <div key={\"trinkwasserbrunnen_\" + index}>\n                    {index > 0 && <br></br>}\n                    <div>\n                      <b>Abstand: </b>\n                      {value.abstand} m\n                    </div>\n                    <div>\n                      <b>Adresse: </b>\n                      {value.str_name + \" \" + value.hsnr + (value.zusatz ? value.zusatz : \"\")}\n                    </div>\n                    <br />\n                    {value.ansprechpartner && getAnsprechpartner(value.ansprechpartner)}\n                  </div>\n                );\n              })}\n            {hitObject.bimschWuppertal && getSeparator(\"BImschG-Anlage Wuppertal\")}\n\n            {hitObject.bimschWuppertal &&\n              hitObject.bimschWuppertal.map((value, index) => {\n                return (\n                  <div key={\"bimschWupp_\" + index}>\n                    {index > 0 && <br></br>}\n                    <div>\n                      <b>Betrieb: </b>\n                      {value.b_firma1}\n                    </div>\n                    <div>\n                      <b>Anlage: </b>\n                      {value.anlag_bez}\n                    </div>\n                    <br />\n                    {value.ansprechpartner && getAnsprechpartner(value.ansprechpartner)}\n                  </div>\n                );\n              })}\n\n            {hitObject.bimschNrw && getSeparator(\"BImschG-Anlage NRW\")}\n\n            {hitObject.bimschNrw &&\n              hitObject.bimschNrw.map((value, index) => {\n                return (\n                  <div key={\"bimschNrw_\" + index}>\n                    {index > 0 && <br></br>}\n                    <div>\n                      <b>Betrieb: </b>\n                      {value.b_firma1}\n                    </div>\n                    <div>\n                      <b>Anlage: </b>\n                      {value.anlag_bez}\n                    </div>\n                    <br />\n                    {value.ansprechpartner && getAnsprechpartner(value.ansprechpartner)}\n                  </div>\n                );\n              })}\n\n            {hitObject.wasserschutzgebiete && getSeparator(\"Wasserschutzgebiet\")}\n\n            {/* mehrere möglich*/}\n            {hitObject.wasserschutzgebiete &&\n              hitObject.wasserschutzgebiete.map((value, index) => {\n                return (\n                  <div key={\"wasser_\" + index}>\n                    {index > 0 && <br></br>}\n                    {value.name && <div>{value.name}</div>}\n                    <div>\n                      <b>Schutzzone: </b>\n                      {value.zone}\n                    </div>\n                    <br />\n                    {value.ansprechpartner && getAnsprechpartner(value.ansprechpartner)}\n                  </div>\n                );\n              })}\n\n            {hitObject.naturschutzgebiete && getSeparator(\"Naturschutzgebiet\")}\n\n            {/* mehrere möglich*/}\n            {hitObject.naturschutzgebiete &&\n              hitObject.naturschutzgebiete.map((value, index) => {\n                return (\n                  <div key={\"natur_\" + index}>\n                    {index > 0 && <br></br>}\n                    <div>{value.nrw_name}</div>\n                    <div>\n                      <b>Objektkennung: </b>\n                      {value.nrw_nummer}\n                    </div>\n                    <br />\n                    {value.ansprechpartner && getAnsprechpartner(value.ansprechpartner)}\n                  </div>\n                );\n              })}\n\n            {hitObject.landschaftsschutzgebiete && getSeparator(\"Landschaftsschutzgebiet\")}\n\n            {/* mehrere möglich*/}\n            {hitObject.landschaftsschutzgebiete &&\n              hitObject.landschaftsschutzgebiete.map((value, index) => {\n                return (\n                  <div key={\"landschaft_\" + index}>\n                    {index > 0 && <br></br>}\n                    <div>\n                      <b>Schutzgebietstyp: </b>\n                      {value.sg_typ === \"LS\" ? \"Landschaftsschutzgebiet\" : value.sg_typ}\n                    </div>\n                    <br />\n                    {value.ansprechpartner && getAnsprechpartner(value.ansprechpartner)}\n                  </div>\n                );\n              })}\n\n            {hitObject.StoerfallBetriebeKlasse1 && getSeparator(\"Störfallbetrieb Abstandsklasse 1\")}\n\n            {hitObject.StoerfallBetriebeKlasse1 &&\n              hitObject.StoerfallBetriebeKlasse1.map((value, index) => {\n                return (\n                  <div key={\"stoer1_\" + index}>\n                    {index > 0 && <br></br>}\n                    <div>\n                      <b>Betrieb: </b>\n                      {value.betrieb}\n                    </div>\n                    <div>\n                      <b>Lage: </b>\n                      {value.lage}\n                    </div>\n                    <br />\n                    {value.ansprechpartner && getAnsprechpartner(value.ansprechpartner)}\n                  </div>\n                );\n              })}\n\n            {hitObject.StoerfallBetriebeKlasse2 && getSeparator(\"Störfallbetrieb Abstandsklasse 2\")}\n\n            {hitObject.StoerfallBetriebeKlasse2 &&\n              hitObject.StoerfallBetriebeKlasse2.map((value, index) => {\n                return (\n                  <div key={\"stoer2_\" + index}>\n                    {index > 0 && <br></br>}\n                    <div>\n                      <b>Betrieb: </b>\n                      {value.betrieb}\n                    </div>\n                    <div>\n                      <b>Lage: </b>\n                      {value.lage}\n                    </div>\n                    <br />\n                    {value.ansprechpartner && getAnsprechpartner(value.ansprechpartner)}\n                  </div>\n                );\n              })}\n          </SecondaryInfoPanelSection>\n        );\n      }\n\n      if (showRawData) {\n        //remove the geometries\n        const hitsForRawDisplay = JSON.parse(JSON.stringify(hits));\n\n        for (const hit of hitsForRawDisplay) {\n          delete hit.geojson;\n        }\n\n        const hitObjectForRawDisplay = objectifyHits(hitsForRawDisplay);\n\n        subSections.push(\n          <SecondaryInfoPanelSection\n            key='standort'\n            bsStyle='info'\n            header={\"Trefferobjekte (Raw Data ohne Geometrie): \" + hits.length + \" Treffer\"}\n          >\n            <div style={{ fontSize: \"115%\", padding: \"10px\", paddingTop: \"0px\" }}>\n              <pre key='hitObject'>{JSON.stringify(hitObjectForRawDisplay, null, 2)}</pre>\n              {/* <pre key='hits'>{JSON.stringify(hitsForRawDisplay, null, 2)}</pre> */}\n            </div>\n          </SecondaryInfoPanelSection>\n        );\n      }\n    }\n    return (\n      <SecondaryInfo\n        titleIconName='info-circle'\n        title={\n          \"Datenblatt zu: \" +\n          Math.round(lat * 10000) / 10000 +\n          \", \" +\n          Math.round(long * 1000) / 1000\n        }\n        mainSection={\n          <div style={{ fontSize: \"115%\", padding: \"10px\", paddingTop: \"0px\" }}>\n            <div>\n              Die Suche an der angegebene Position hat insgesamt {hits.length} Treffer ergeben:\n              {display(\"Bezeichnung\", hits?.bezeichnung)}\n              {display(\"Flächengröße\", hits?.groesse, (a) => (\n                <span>\n                  {a.toLocaleString()} m² (circa{\" \"}\n                  {(Math.round((a / 10000) * 10) / 10).toLocaleString()} ha)\n                </span>\n              ))}\n              {display(\"Stadtbezirk(e)\", hits?.stadtbezirke, (sb) => sb.join(\", \"))}\n              {display(\"Quartier(e)\", hits?.quartiere, (q) => q.join(\", \"))}\n              {display(\"Eigentümer\", hits?.eigentuemer, (e) => e.join(\", \"))}\n            </div>\n          </div>\n        }\n        subSections={subSections}\n        footer={footer}\n      />\n    );\n  } else {\n    return null;\n  }\n};\nexport default InfoPanel;\n","import { useContext } from \"react\";\n\nimport { ResponsiveTopicMapContext } from \"react-cismap/contexts/ResponsiveTopicMapContextProvider\";\n\nconst Comp = () => {\n  const { windowSize } = useContext(ResponsiveTopicMapContext);\n\n  return (\n    <div>\n      <div\n        style={{\n          position: \"absolute\",\n          top: (windowSize?.height || 500) / 2 - 1,\n          width: windowSize?.width || \"100%\",\n          height: \"2px\",\n          backgroundColor: \"#00000023\",\n          zIndex: \"100000\",\n          pointerEvents: \"none\",\n        }}\n      ></div>\n      <div\n        style={{\n          position: \"absolute\",\n          left: (windowSize?.width || 500) / 2 - 1,\n          height: windowSize?.height || \"100%\",\n          width: \"2px\",\n          backgroundColor: \"#00000023\",\n          zIndex: \"100000\",\n          pointerEvents: \"none\",\n        }}\n      ></div>\n      <div\n        style={{\n          borderRadius: \"50%\",\n          position: \"absolute\",\n          left: (windowSize?.width || 500) / 2 - 10,\n          top: (windowSize?.height || 500) / 2 - 10,\n          height: \"20px\",\n          width: \"20px\",\n          backgroundColor: \"#00000023\",\n          zIndex: \"100000\",\n          pointerEvents: \"none\",\n        }}\n      ></div>\n    </div>\n  );\n};\n\nexport default Comp;\n","import { faSearch, faSquare } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport bboxPolygon from \"@turf/bbox-polygon\";\nimport turfCenter from \"@turf/center\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport Color from \"color\";\nimport \"leaflet/dist/leaflet.css\";\nimport { useContext, useEffect, useState } from \"react\";\nimport \"react-bootstrap-typeahead/css/Typeahead.css\";\nimport { FeatureCollectionDisplay } from \"react-cismap\";\nimport { ResponsiveTopicMapContext } from \"react-cismap/contexts/ResponsiveTopicMapContextProvider\";\nimport { TopicMapContext } from \"react-cismap/contexts/TopicMapContextProvider\";\nimport { md5FetchText } from \"react-cismap/tools/fetching\";\nimport { getGazDataForTopicIds } from \"react-cismap/tools/gazetteerHelper\";\nimport \"react-cismap/topicMaps.css\";\nimport TopicMapComponent from \"react-cismap/topicmaps/TopicMapComponent\";\nimport Control from \"react-leaflet-control\";\nimport { daqKeys, db } from \"./App\";\nimport \"./App.css\";\nimport InfoBox, { modes } from \"./components/InfoBox\";\nimport MyMenu from \"./components/Menu\";\nimport InfoPanel from \"./components/SecondaryInfo\";\nimport Crosshair from \"./Crosshair\";\nimport { searchForFeatures } from \"./search\";\n\nconst host = \"https://wupp-topicmaps-data.cismet.de\";\n\nconst getData = async (setGazData) => {\n  const prefix = \"GazDataForStories\";\n  const sources = {};\n\n  //  sources.stoerfallbetrieb = await md5ActionFetchDAQ4Dexie(prefix, 'url', 'xxx', 'daqStoerfallBetriebeKlasse1');\n  sources.adressen = await md5FetchText(prefix, host + \"/data/3857/adressen.json\");\n  sources.bezirke = await md5FetchText(prefix, host + \"/data/3857/bezirke.json\");\n  sources.quartiere = await md5FetchText(prefix, host + \"/data/3857/quartiere.json\");\n  sources.pois = await md5FetchText(prefix, host + \"/data/3857/pois.json\");\n  sources.kitas = await md5FetchText(prefix, host + \"/data/3857/kitas.json\");\n\n  const gazData = getGazDataForTopicIds(sources, [\n    \"pois\",\n    \"kitas\",\n    \"bezirke\",\n    \"quartiere\",\n    \"adressen\",\n  ]);\n\n  setGazData(gazData);\n};\n\nconst convertToFeature = (_item) => {\n  const item = JSON.parse(JSON.stringify(_item));\n\n  const geometry = item?.geojson;\n  const selected = false;\n  const type = \"Feature\";\n  let text = item?.bezeichnung;\n  switch (item.typ) {\n    case \"naturschutzgebiete\":\n      text = item?.nrw_name;\n      item.color = \"#649351\";\n      break;\n    case \"landschaftsschutzgebiete\":\n      text = \"Landschaftsschutzgebiet\";\n      item.color = \"#97C146\";\n\n      break;\n    case \"stadtFlurstuecke\":\n      text = item?.flurstueck;\n      item.color = \"#dddddd\";\n      item.opcaity = 0.3;\n      break;\n    case \"trinkwasserbrunnen\":\n      text = item?.str_name + \" \" + item?.hsnr;\n      item.color = \"#A7DBD8\";\n      item.opcaity = 0.3;\n\n      break;\n    case \"bimschWuppertal\":\n      text = item?.b_firma1;\n      item.color = \"#774F38\";\n\n      break;\n    case \"bimschNrw\":\n      text = item?.b_firma1;\n\n      item.color = \"#774F38\";\n\n      break;\n    case \"wasserschutzgebiete\":\n      text = item?.zone;\n      if (item?.zone === \"I\") {\n        item.color = \"#F4C900\";\n      } else if (item?.zone === \"II\") {\n        item.color = \"#FAE842\";\n      } else if (item?.zone === \"III\") {\n        item.color = \"#FFFF99\";\n      } else {\n        item.color = \"#69D2E7\";\n      }\n\n      break;\n    case \"StoerfallBetriebeKlasse1\":\n      text = item?.betrieb;\n      item.color = \"#DD4A36\";\n      break;\n    case \"StoerfallBetriebeKlasse2\":\n      text = item?.betrieb;\n      item.color = \"#DD4A36\";\n      item.opacity = 0.3;\n\n      break;\n\n    default:\n      return undefined;\n  }\n\n  return {\n    id: item.typ + \".\" + item.id,\n    text,\n    type,\n    selected,\n    geometry,\n    crs: geometry?.crs || {\n      type: \"name\",\n      properties: {\n        name: \"urn:ogc:def:crs:EPSG::25832\",\n      },\n    },\n    properties: item,\n  };\n};\n\nconst style = (feature) => {\n  let color = new Color(feature?.properties?.color || \"#ff0000\");\n  let linecolor = new Color(feature?.properties?.color || \"#ff0000\").darken(0.5);\n\n  return {\n    fillColor: color,\n    color: linecolor,\n    opacity: 0.5,\n    fillOpacity: feature?.properties?.opacity || 0.6,\n\n    weight: 0.5,\n  };\n};\n\nfunction UmweltalarmMap({ loggedOut, initialised }) {\n  const { routedMapRef } = useContext(TopicMapContext);\n  const mapRef = routedMapRef?.leafletMap?.leafletElement;\n  const currentZoom = mapRef?.getZoom();\n  const [gazData, setGazData] = useState([]);\n  const [isFeatureCollectionVisible, setFeatureCollectionVisible] = useState(false);\n\n  const [hits, setHits] = useState([]);\n  const [searchMode, setSearchMode] = useState(modes.CENTER);\n  const [featureCollection, setFeatureCollection] = useState([]);\n  const [bbPoly, setBBPoly] = useState();\n  const { windowSize } = useContext(ResponsiveTopicMapContext);\n\n  useEffect(() => {\n    getData(setGazData);\n  }, []);\n\n  useEffect(() => {\n    const features = [];\n    for (const hit of hits || []) {\n      const f = convertToFeature(hit);\n      if (f) {\n        features.push(f);\n      }\n    }\n    setFeatureCollection(features);\n  }, [hits]);\n\n  const searchInWholeWindowEnabled = currentZoom && currentZoom >= 16;\n  return (\n    <div key={initialised != null ? initialised : \"init\"}>\n      <Crosshair />\n      <TopicMapComponent\n        gazData={gazData}\n        modalMenu={<MyMenu />}\n        homeZoom={13}\n        maxZoom={22}\n        applicationMenuTooltipString='Einstellungen | Legende | Kompaktanleitung'\n        secondaryInfo={windowSize && <InfoPanel hits={hits} />}\n        locatorControl={true}\n        mappingBoundsChanged={(boundingBox) => {\n          setHits(undefined);\n          let bbox = [boundingBox.left, boundingBox.bottom, boundingBox.right, boundingBox.top];\n          let bbPoly = bboxPolygon(bbox);\n\n          //   console.log(\"xxx mappingBoundsChanged\", center);\n          let center = turfCenter(bbPoly);\n\n          searchForFeatures(db, daqKeys, center).then((hits) => {\n            setSearchMode(modes.CENTER);\n            setHits(hits);\n            setBBPoly(bbPoly);\n          });\n        }}\n      >\n        {!loggedOut && (\n          <InfoBox\n            mode={searchMode}\n            isFeatureCollectionVisible={isFeatureCollectionVisible}\n            setFeatureCollectionVisible={setFeatureCollectionVisible}\n            hits={hits}\n          />\n        )}\n        {isFeatureCollectionVisible && (\n          <FeatureCollectionDisplay style={style} featureCollection={featureCollection} />\n        )}\n\n        <Control className='leaflet-bar' position={\"topleft\"}>\n          <button\n            title='Objekte im Kartenfenster suchen'\n            disabled={!searchInWholeWindowEnabled}\n            onClick={() => {\n              setHits();\n\n              searchForFeatures(db, daqKeys, bbPoly).then((hits) => {\n                setSearchMode(modes.WINDOW);\n\n                setHits(hits);\n              });\n            }}\n            className='easy-button-button leaflet-bar-part leaflet-interactive unnamed-state-active'\n          >\n            <span\n              style={{ color: searchInWholeWindowEnabled ? \"#444444\" : \"#bbbbbb\" }}\n              className='fa-layers fa-fw '\n            >\n              <FontAwesomeIcon transform='grow-9' icon={faSearch} size='lg' />\n              <FontAwesomeIcon transform='shrink-8 up-2 left-2.3' icon={faSquare} size='lg' />\n            </span>\n          </button>\n        </Control>\n      </TopicMapComponent>\n    </div>\n  );\n}\n\nexport default UmweltalarmMap;\n","export const offlineConfig = {\n  rules: [\n    {\n      origin: \"https://omt.map-hosting.de/fonts/Metropolis Medium Italic,Noto\",\n      cachePath: \"fonts/Open\",\n    },\n    {\n      origin: \"https://omt.map-hosting.de/fonts/Klokantech Noto\",\n      cachePath: \"fonts/Open\",\n    },\n    {\n      origin: \"https://omt.map-hosting.de/fonts/Metropolis Regular,Noto\",\n      cachePath: \"fonts/Open\",\n      realServerFallback: false,\n    },\n    {\n      origin: \"https://omt.map-hosting.de/fonts\",\n      cachePath: \"fonts\",\n    },\n    {\n      origin: \"https://omt.map-hosting.de/styles\",\n      cachePath: \"styles\",\n    },\n\n    {\n      origin: \"https://omt.map-hosting.de/data/v3\",\n      cachePath: \"tiles\",\n    },\n\n    {\n      origin: \"https://omt.map-hosting.de/data/gewaesser\",\n      cachePath: \"tiles.gewaesser\",\n    },\n\n    {\n      origin: \"https://omt.map-hosting.de/data/kanal\",\n      cachePath: \"tiles.kanal\",\n    },\n\n    {\n      origin: \"https://omt.map-hosting.de/data/brunnen\",\n      cachePath: \"tiles.brunnen\",\n      // realServerFallback: true, //this can override the globalsetting\n    },\n  ],\n  dataStores: [\n    {\n      name: \"Vektorkarte für Wuppertal\",\n      key: \"wuppBasemap\",\n      url: \"https://offline-data.cismet.de/offline-data/wupp.zip\",\n    },\n\n    {\n      name: \"Gewässer, Kanal und Brunnendaten\",\n      key: \"umweltalarm\",\n      url: \"https://offline-data.cismet.de/offline-data/umweltalarm.zip\",\n    },\n  ],\n  offlineStyles: [\n    \"https://omt.map-hosting.de/styles/cismet-light/style.json\",\n    \"https://omt.map-hosting.de/styles/osm-bright-grey/style.json\",\n    \"https://omt.map-hosting.de/styles/brunnen/style.json\",\n    \"https://omt.map-hosting.de/styles/kanal/style.json\",\n    \"https://omt.map-hosting.de/styles/gewaesser/style.json\",\n  ],\n  realServerFallback: true, //should be true in production\n  consoleDebug: false,\n  optional: true,\n  initialActive: true,\n};\n","import \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"leaflet/dist/leaflet.css\";\nimport localforage from \"localforage\";\nimport { useEffect, useState } from \"react\";\nimport \"react-bootstrap-typeahead/css/Typeahead.css\";\nimport { MappingConstants } from \"react-cismap\";\nimport TopicMapContextProvider from \"react-cismap/contexts/TopicMapContextProvider\";\nimport { getInternetExplorerVersion } from \"react-cismap/tools/browserHelper\";\nimport { defaultLayerConf } from \"react-cismap/tools/layerFactory\";\nimport \"react-cismap/topicMaps.css\";\nimport MapLibreLayer from \"react-cismap/vector/MapLibreLayer\";\nimport \"./App.css\";\nimport LoginForm from \"./components/LoginForm\";\nimport Title from \"./components/TitleControl\";\nimport {\n  indexAnsprechpartner,\n  indexAnsprechpartnerZustaendigkeit,\n  initTables,\n  md5ActionFetchDAQ4Dexie,\n} from \"./md5Fetching\";\nimport UmweltalarmMap from \"./UmweltalarmMap\";\nimport LogConsole from \"react-cismap/tools/LogConsole\";\nimport { offlineConfig } from \"./offlineConfig\";\n\nexport const appKey = \"umweltalarm.Online.Wuppertal\";\nexport const apiUrl = \"https://umweltalarm-api.cismet.de\";\nexport const daqKeys = [\n  \"StoerfallBetriebeKlasse1\",\n  \"StoerfallBetriebeKlasse2\",\n  \"wasserverbaende\",\n  \"wasserschutzgebiete\",\n  \"autobahnmeisterei\",\n  \"landschaftsschutzgebiete\",\n  \"naturschutzgebiete\",\n  \"strassenmeisterei\",\n  \"bimschNrw\",\n  \"bimschWuppertal\",\n  \"trinkwasserbrunnen\",\n  \"stadtFlurstuecke\",\n];\nexport const db = initTables(appKey, daqKeys);\n\nfunction App() {\n  let backgroundModes;\n  useEffect(() => {\n    document.title = \"Umweltalarm Wuppertal\";\n  }, []);\n  const showConsole = new URLSearchParams(window.location.href).get(\"consoleOverlay\") !== null;\n\n  const [jwt, _setJWT] = useState();\n  const [loggedOut, setLoggedOut] = useState();\n  const [loginInfo, setLoginInfo] = useState();\n  const [initialised, setInitialised] = useState();\n  const [checkedForJWT, setCheckedForJWT] = useState(false);\n  const setJWT = (jwt) => {\n    // eslint-disable-next-line\n    localforage.setItem(\"@\" + appKey + \".\" + \"auth\" + \".\" + \"jwt\", jwt);\n    _setJWT(jwt);\n  };\n\n  useEffect(() => {\n    (async () => {\n      // eslint-disable-next-line\n      const jwtInCache = await localforage.getItem(\"@\" + appKey + \".\" + \"auth\" + \".\" + \"jwt\");\n      if (jwtInCache) {\n        setJWT(jwtInCache);\n        setLoggedOut(false);\n        setCheckedForJWT(true);\n      } else {\n        setJWT(undefined);\n        setLoggedOut(true);\n        setCheckedForJWT(true);\n      }\n    })();\n  }, []);\n\n  useEffect(() => {\n    if (jwt) {\n      const tasks = [];\n      for (const daqKey of daqKeys) {\n        tasks.push(md5ActionFetchDAQ4Dexie(appKey, apiUrl, jwt, daqKey, db));\n      }\n      tasks.push(md5ActionFetchDAQ4Dexie(appKey, apiUrl, jwt, \"ansprechpartner\", db));\n      tasks.push(md5ActionFetchDAQ4Dexie(appKey, apiUrl, jwt, \"ansprechpartnerZustaendigkeit\", db));\n\n      Promise.all(tasks).then(\n        (results) => {\n          for (const result of results) {\n            if (result.daqKey === \"ansprechpartner\" && Array.isArray(result.data)) {\n              indexAnsprechpartner(result.data, \"ansprechpartner\", db);\n            } else if (\n              result.daqKey === \"ansprechpartnerZustaendigkeit\" &&\n              Array.isArray(result.data)\n            ) {\n              indexAnsprechpartnerZustaendigkeit(result.data, \"ansprechpartnerZustaendigkeit\", db);\n            }\n          }\n          setInitialised(\"initialised complete\");\n        },\n        (problem) => {\n          setJWT(undefined);\n          setLoginInfo({ color: \"#F9D423\", text: \"Bitte melden Sie sich erneut an.\" });\n          setTimeout(() => {\n            setLoginInfo();\n          }, 2500);\n        }\n      );\n    } else {\n      setLoggedOut(true);\n      //      setDynGazData([]);\n    }\n  }, [jwt]);\n\n  if (getInternetExplorerVersion() === -1) {\n    backgroundModes = [\n      {\n        title: \"Stadtplan\",\n        mode: \"default\",\n        layerKey: \"stadtplan\",\n      },\n      {\n        title: \"Stadtplan (grau)\",\n        mode: \"default\",\n        layerKey: \"vectorCityMap2\",\n        offlineDataStoreKey: \"wuppBasemap\",\n      },\n      {\n        title: \"Stadtplan (bunt)\",\n        mode: \"default\",\n        layerKey: \"vectorCityMap\",\n        offlineDataStoreKey: \"wuppBasemap\",\n      },\n      { title: \"Luftbildkarte\", mode: \"default\", layerKey: \"lbk\" },\n    ];\n  } else {\n    backgroundModes = [\n      {\n        title: \"Stadtplan\",\n        mode: \"default\",\n        layerKey: \"stadtplan\",\n      },\n      { title: \"Luftbildkarte\", mode: \"default\", layerKey: \"lbk\" },\n    ];\n  }\n  const backgroundConfigurations = {\n    lbk: {\n      layerkey: \"rvrGrundriss@100|trueOrtho2020@75|rvrSchriftNT@100\",\n      src: \"/images/rain-hazard-map-bg/ortho.png\",\n      title: \"Luftbildkarte\",\n    },\n    stadtplan: {\n      layerkey: \"wupp-plan-live@60\",\n      src: \"/images/rain-hazard-map-bg/citymap.png\",\n      title: \"Stadtplan\",\n    },\n    vectorCityMap2: {\n      layerkey: \"cismetLight\",\n      src: \"/images/rain-hazard-map-bg/citymap.png\",\n      title: \"Stadtplan\",\n    },\n\n    vectorCityMap: {\n      layerkey: \"osmBrightOffline\",\n      src: \"/images/rain-hazard-map-bg/citymap.png\",\n      title: \"Stadtplan\",\n    },\n  };\n\n  // const baseLayerConf = JSON.parse(JSON.stringify(defaultLayerConf));\n  // TODO problems in settings preview map wehen doing the immutable way\n\n  const baseLayerConf = { ...defaultLayerConf };\n  if (!baseLayerConf.namedLayers.cismetLight) {\n    baseLayerConf.namedLayers.cismetLight = {\n      type: \"vector\",\n      style: \"https://omt.map-hosting.de/styles/cismet-light/style.json\",\n      offlineAvailable: true,\n      offlineDataStoreKey: \"wuppBasemap\",\n      pane: \"backgroundvectorLayers\",\n    };\n  }\n  if (!baseLayerConf.namedLayers.osmBrightOffline) {\n    baseLayerConf.namedLayers.osmBrightOffline = {\n      type: \"vector\",\n      style: \"https://omt.map-hosting.de/styles/osm-bright-grey/style.json\",\n      offlineAvailable: true,\n      offlineDataStoreKey: \"wuppBasemap\",\n      pane: \"backgroundvectorLayers\",\n    };\n  }\n\n  let loginForm = null;\n  if (loggedOut && checkedForJWT === true && jwt === undefined) {\n    loginForm = (\n      <LoginForm\n        key={\"login.\"}\n        setJWT={setJWT}\n        loginInfo={loginInfo}\n        setLoginInfo={setLoginInfo}\n        setLoggedOut={setLoggedOut}\n      />\n    );\n  }\n\n  //MapLibreLayer has a style attribute wich isn't liked by the linter\n  //will be fixed soon\n  /*eslint react/style-prop-object: \"off\"*/\n\n  return (\n    <TopicMapContextProvider\n      additionalLayerConfiguration={{\n        brunnen: {\n          title: <span>Trinkwasserbrunnen</span>,\n          initialActive: false,\n          layer: (\n            <MapLibreLayer\n              key={\"brunnen\"}\n              style='https://omt.map-hosting.de/styles/brunnen/style.json'\n              pane='additionalLayers0'\n              offlineAvailable={true}\n              offlineDataStoreKey='umweltalarm'\n            />\n          ),\n          offlineDataStoreKey: \"umweltalarm\",\n        },\n        kanal: {\n          title: <span>Kanalnetz</span>,\n          initialActive: false,\n          layer: (\n            <MapLibreLayer\n              key={\"kanal\"}\n              style='https://omt.map-hosting.de/styles/kanal/style.json'\n              pane='additionalLayers1'\n              offlineAvailable={true}\n              offlineDataStoreKey='umweltalarm'\n            />\n          ),\n          offlineDataStoreKey: \"umweltalarm\",\n        },\n        gewaesser: {\n          title: <span>Gewässernetz</span>,\n          initialActive: false,\n          layer: (\n            <MapLibreLayer\n              key={\"gewaesser\"}\n              style='https://omt.map-hosting.de/styles/gewaesser/style.json'\n              pane='additionalLayers2'\n              offlineAvailable={true}\n              offlineDataStoreKey='umweltalarm'\n            />\n          ),\n          offlineDataStoreKey: \"umweltalarm\",\n        },\n      }}\n      baseLayerConf={baseLayerConf}\n      offlineCacheConfig={offlineConfig}\n      backgroundConfigurations={backgroundConfigurations}\n      backgroundModes={backgroundModes}\n      referenceSystem={MappingConstants.crs3857}\n      mapEPSGCode='3857'\n      referenceSystemDefinition={MappingConstants.proj4crs3857def}\n      maskingPolygon='POLYGON((668010.063156992 6750719.23021889,928912.612468322 6757273.20343972,930494.610325512 6577553.43685138,675236.835570551 6571367.64964125,668010.063156992 6750719.23021889))'\n    >\n      {/* {loggedOut && checkedForJWT === true && jwt === undefined && (\n        <LoginForm\n          key={\"login.\"}\n          setJWT={setJWT}\n          loginInfo={loginInfo}\n          setLoginInfo={setLoginInfo}\n        />\n      )} */}\n      {loginForm}\n      {!loggedOut && (\n        <Title\n          logout={() => {\n            setJWT(undefined);\n            setLoggedOut(true);\n            setLoginInfo({ color: \"#69D2E7\", text: \"Sie wurden erfolgreich abgemeldet.\" });\n            setTimeout(() => {\n              setLoginInfo();\n            }, 2500);\n          }}\n          jwt={jwt}\n        />\n      )}\n      {showConsole && <LogConsole ghostModeAvailable={true} minifyAvailable={true} />}\n      <UmweltalarmMap loggedOut={loggedOut} initialised={initialised} />\n    </TopicMapContextProvider>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://cra.link/PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://cra.link/PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { \"Service-Worker\": \"script\" },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\"No internet connection found. App is running in offline mode.\");\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport * as serviceWorkerRegistration from \"./serviceWorkerRegistration\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://cra.link/PWA\nserviceWorkerRegistration.register();\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}